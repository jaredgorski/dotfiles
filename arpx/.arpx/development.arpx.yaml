processes:
  # Start
  - name: start
    color: blue
    command: ./start.sh
    cwd: /Users/jaredgorski/Projects/Liferay/development
    onsucceed: process:_waitReady

  - name: _waitReady
    color: yellow
    command: |
      THRESHOLD=12

      while true
      do
        sleep 3

        NUM_RUNNING=$(kubectl get pods | grep -c "Running")
        if [ $NUM_RUNNING -ge $THRESHOLD ]
        then
          echo "[ $NUM_RUNNING / $THRESHOLD ] -- All pods running."
          exit 0
        else
          echo "[ $NUM_RUNNING / $THRESHOLD ] -- Waiting on pods..."
        fi
      done
    onsucceed: process:_finish

  - name: _finish
    color: green
    command: |
      echo "Development is ready. Happy programming!"
      osascript -e 'display notification "Development is ready. Happy programming!" with title "arpx" sound name "Startup"'

  # Stop
  - name: stop
    color: red
    command: |
      ./stop.sh
      osascript -e 'display notification "Development is fully stopped." with title "arpx" sound name "Ping"'
    cwd: /Users/jaredgorski/Projects/Liferay/development
